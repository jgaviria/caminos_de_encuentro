<%
  # Form field component
  # Usage: <%= render 'shared/form_field', form: form, field: :name, label: 'Full Name', type: 'text', required: true %>
  
  form = local_assigns[:form]
  field = local_assigns[:field]
  label = local_assigns[:label]
  type = local_assigns[:type] || 'text'
  required = local_assigns[:required] || false
  placeholder = local_assigns[:placeholder]
  help_text = local_assigns[:help_text]
  icon = local_assigns[:icon]
  options = local_assigns[:options]
  
  field_classes = "block w-full rounded-lg border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm"
  field_classes += " pl-10" if icon
  
  label_classes = "block text-sm font-medium text-gray-700 mb-2"
%>

<div class="mb-4">
  <%= form.label field, label, class: label_classes do %>
    <%= label %>
    <% if required %>
      <span class="text-red-500 ml-1">*</span>
    <% end %>
  <% end %>
  
  <div class="relative">
    <% if icon %>
      <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
        <svg class="h-5 w-5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <%= icon.html_safe %>
        </svg>
      </div>
    <% end %>
    
    <% case type %>
    <% when 'select' %>
      <%= form.select field, options, { prompt: placeholder }, { class: field_classes, required: required } %>
    <% when 'textarea' %>
      <%= form.text_area field, placeholder: placeholder, class: field_classes, required: required, rows: 4 %>
    <% when 'email' %>
      <%= form.email_field field, placeholder: placeholder, class: field_classes, required: required %>
    <% when 'password' %>
      <%= form.password_field field, placeholder: placeholder, class: field_classes, required: required %>
    <% when 'number' %>
      <%= form.number_field field, placeholder: placeholder, class: field_classes, required: required %>
    <% when 'tel' %>
      <%= form.telephone_field field, placeholder: placeholder, class: field_classes, required: required %>
    <% when 'checkbox' %>
      <div class="flex items-center">
        <%= form.check_box field, class: "h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded", required: required %>
        <%= form.label field, label, class: "ml-2 block text-sm text-gray-900" %>
      </div>
    <% else %>
      <%= form.text_field field, placeholder: placeholder, class: field_classes, required: required %>
    <% end %>
  </div>
  
  <% if help_text %>
    <p class="mt-1 text-sm text-gray-500"><%= help_text %></p>
  <% end %>
  
  <% if form.object.errors[field].any? %>
    <div class="mt-1">
      <% form.object.errors[field].each do |error| %>
        <p class="text-sm text-red-600"><%= error %></p>
      <% end %>
    </div>
  <% end %>
</div>