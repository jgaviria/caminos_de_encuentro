<%# Form field component %>
<%# Usage: <%= render 'shared/form_field', form: form, field: :name, label: 'Full Name', type: 'text', required: true %>

<div class="mb-4">
  <%= local_assigns[:form].label local_assigns[:field], class: "block text-sm font-medium text-gray-700 mb-2" do %>
    <%= local_assigns[:label] %>
    <% if local_assigns[:required] %>
      <span class="text-red-500 ml-1">*</span>
    <% end %>
  <% end %>
  
  <div class="relative">
    <% if local_assigns[:icon] %>
      <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
        <svg class="h-5 w-5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <%= local_assigns[:icon].html_safe %>
        </svg>
      </div>
    <% end %>
    
    <% field_type = local_assigns[:type] || 'text' %>
    <% case field_type %>
    <% when 'select' %>
      <%= local_assigns[:form].select local_assigns[:field], local_assigns[:options], { prompt: local_assigns[:placeholder] }, { class: (local_assigns[:icon] ? "block w-full rounded-lg border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm pl-10" : "block w-full rounded-lg border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm"), required: (local_assigns[:required] || false) } %>
    <% when 'textarea' %>
      <%= local_assigns[:form].text_area local_assigns[:field], placeholder: local_assigns[:placeholder], class: (local_assigns[:icon] ? "block w-full rounded-lg border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm pl-10" : "block w-full rounded-lg border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm"), required: (local_assigns[:required] || false), rows: 4 %>
    <% when 'email' %>
      <%= local_assigns[:form].email_field local_assigns[:field], placeholder: local_assigns[:placeholder], class: (local_assigns[:icon] ? "block w-full rounded-lg border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm pl-10" : "block w-full rounded-lg border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm"), required: (local_assigns[:required] || false) %>
    <% when 'password' %>
      <%= local_assigns[:form].password_field local_assigns[:field], placeholder: local_assigns[:placeholder], class: (local_assigns[:icon] ? "block w-full rounded-lg border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm pl-10" : "block w-full rounded-lg border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm"), required: (local_assigns[:required] || false) %>
    <% when 'number' %>
      <%= local_assigns[:form].number_field local_assigns[:field], placeholder: local_assigns[:placeholder], class: (local_assigns[:icon] ? "block w-full rounded-lg border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm pl-10" : "block w-full rounded-lg border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm"), required: (local_assigns[:required] || false) %>
    <% when 'tel' %>
      <%= local_assigns[:form].telephone_field local_assigns[:field], placeholder: local_assigns[:placeholder], class: (local_assigns[:icon] ? "block w-full rounded-lg border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm pl-10" : "block w-full rounded-lg border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm"), required: (local_assigns[:required] || false) %>
    <% when 'checkbox' %>
      <div class="flex items-center">
        <%= local_assigns[:form].check_box local_assigns[:field], class: "h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded", required: (local_assigns[:required] || false) %>
        <%= local_assigns[:form].label local_assigns[:field], local_assigns[:label], class: "ml-2 block text-sm text-gray-900" %>
      </div>
    <% else %>
      <%= local_assigns[:form].text_field local_assigns[:field], placeholder: local_assigns[:placeholder], class: (local_assigns[:icon] ? "block w-full rounded-lg border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm pl-10" : "block w-full rounded-lg border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 text-sm"), required: (local_assigns[:required] || false) %>
    <% end %>
  </div>
  
  <% if local_assigns[:help_text] %>
    <p class="mt-1 text-sm text-gray-500"><%= local_assigns[:help_text] %></p>
  <% end %>
  
  <% if local_assigns[:form]&.object&.errors&.[](local_assigns[:field])&.any? %>
    <div class="mt-1">
      <% local_assigns[:form].object.errors[local_assigns[:field]].each do |error| %>
        <p class="text-sm text-red-600"><%= error %></p>
      <% end %>
    </div>
  <% end %>
</div>